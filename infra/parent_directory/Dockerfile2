FROM alpine:latest

# Install necessary tools
RUN apk add --no-cache curl tar

# Download ngrok (version 3 stable) and extract it
RUN curl -sL https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-linux-amd64.tgz -o /tmp/ngrok.tgz && \
    tar -xvzf /tmp/ngrok.tgz -C /usr/local/bin && \
    rm /tmp/ngrok.tgz

# Expose port 443 for HTTPS
#EXPOSE 443

# Set environment variable for ngrok authtoken
ENV NGROK_AUTHTOKEN=${NGROK_AUTHTOKEN}

# Start ngrok with the authtoken and expose the container's port
ENTRYPOINT ["sh", "-c", "ngrok authtoken $NGROK_AUTHTOKEN && ngrok http 3000"]
